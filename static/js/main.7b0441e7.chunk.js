(this["webpackJsonploop-maker"]=this["webpackJsonploop-maker"]||[]).push([[0],{112:function(e,t,n){},114:function(e,t,n){},138:function(e,t,n){"use strict";n.r(t);var c=n(0),r=n.n(c),a=n(33),o=n.n(a),i=n(43),s=(n(112),n(113),n(5)),u=n(101),l=n(191),j={main:"#646464",secondary:"#fff",bg:"#3E3C3C",dark:"#525151",light:"#706c6c",red:"#ea9191",yellow:"#E3EA91",blue:"#91b9ea",green:"#91eabb",white:"#ccc"},b=[1,2,3,4,5],d={1:"red",2:"yellow",3:"blue",4:"green",5:"white"},O=(n(114),n(20)),f=n(192),h=n(4),x=function(){return Object(h.jsxs)("div",{children:[Object(h.jsx)("h1",{children:"Home View"}),b.map((function(e){return Object(h.jsx)(i.b,{to:"track-".concat(e),children:Object(h.jsxs)(f.a,{children:["Go to track"," ",e]})},"track-".concat(e,"-link"))}))]})},m=n(6),p=n.n(m),v=n(15),g=n(7),C=n(16),k=n(8),A=n(53),w=n(97),y=n.n(w),D=["B","A#","A","G#","G","F#","F","E","D#","D","C#","C"],E=(["C"].concat(D,D),"__"),G=8,F=4,B=2,S=1,I=["bass-electric","cello","flute","guitar-acoustic","guitar-electric","piano","saxophone","violin"],z={"bass-electric":["As5","G5","E5","Cs5","As4","G4","E4","Cs4","As3","G3","E3","Cs3","As2","G2","E2","Cs2"],cello:["B4","As4","A4","Gs4","G4","Fs4","F4","E4","Ds4","D4","Cs4","C4","B3","As3","A3","Gs3","G3","Fs3","F3","E3","Ds3","D3","Cs3","C3"],clarinet:["F2","D3","F3","D4","D5","F4","Fs5","As2","As3","As4","D2"],flute:["C6","A5","E5","C5","A4","E4","C4","A3","E3","C3"],"guitar-acoustic":["B3","As3","A3","Gs3","G3","Fs3","F3","E3","Ds3","D3","Cs3","C3","B2","As2","A2","Gs2","G2","Fs2","F2","E2","Ds2","D2","Cs2","C2"],"guitar-electric":["A5","Fs5","Ds5","C5","A4","Fs4","Ds4","C4","A3","Fs3","Ds3","C3"],harp:["B3","C5","D2","D4","D6","D7","E1","E3","E5","F2","F4","F6","F7","G1","G3","G5","A2","A4","A6","B1","B5","B6","C3"],piano:["C5","B4","As4","A4","Gs4","G4","Fs4","F4","E4","Ds4","D4","Cs4","C4","B3","As3","A3","Gs3","G3","Fs3","F3","E3","Ds3","D3","Cs3","C3"],saxophone:["B3","As3","A3","Gs3","G3","Fs3","F3","E3","Ds3","D3","Cs3","C3"],violin:["C6","A5","G5","E5","C5","A4","G4","E4","C4"]},M=n(193),N=n(190),T=function(e){var t=e.playDuration,n=e.trackColor,r=e.display,a=e.onCancel,o=e.reset,i=Object(c.useState)(Math.random()),s=Object(k.a)(i,2),u=s[0],l=s[1],j=Object(c.useState)(0),b=Object(k.a)(j,2),d=b[0],O=b[1],x=0!==t&&r,m=function(){O(0),l(Math.random())};Object(c.useEffect)((function(){var e;return o&&m(),t>0?e=setInterval((function(){O((function(e){return 100===e?e:e+1}))}),t/100):m(),function(){e&&(m(),clearInterval(e))}}),[t,r,o]);var p="primary.".concat(n);return x?Object(h.jsxs)(f.a,{position:"absolute",bgcolor:"rgba(0, 0, 0, 0.1)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",sx:{backdropFilter:"blur(1px)",zIndex:99,top:0,left:0,right:0,bottom:0},children:[Object(h.jsx)(f.a,{color:"#fff",fontWeight:"bold",fontSize:"32px",children:"PLAYING AUDIO"}),Object(h.jsx)(f.a,{width:"20vw",color:p,sx:{marginTop:3},children:Object(h.jsx)(M.a,{color:"inherit",variant:"determinate",value:d},u)}),Object(h.jsx)(N.a,{onClick:a,variant:"outlined",sx:{color:p,borderColor:p,marginTop:4},children:"Cancel"})]}):null};T.defaultProps={trackColor:"yellow",onCancel:function(){}};var L=T,R=n(180),V=n(194),W=n(195),P=n(196),J=n(197),U=n(185),_=n(188),H=n(186),Y=n(198),q=n(183),K=n(187),Q=n(100),X=n.n(Q),Z=n(98),$=n.n(Z),ee=n(99),te=b.reduce((function(e,t){return Object(s.a)(Object(s.a)({},e),{},Object(g.a)({},t,[]))}),{}),ne=b.reduce((function(e,t){return Object(s.a)(Object(s.a)({},e),{},Object(g.a)({},t,{}))}),{}),ce=b.reduce((function(e,t){return Object(s.a)(Object(s.a)({},e),{},Object(g.a)({},t,"piano"))}),{}),re=Object(c.createContext)({activeBoxes:te,activeBoxesValues:ne,instruments:ce,tempo:120,gridLength:40}),ae=function(e){var t=e.children,n=Object(c.useState)(te),r=Object(k.a)(n,2),a=r[0],o=r[1],i=Object(c.useState)(ne),u=Object(k.a)(i,2),l=u[0],j=u[1],d=Object(c.useState)(ce),O=Object(k.a)(d,2),f=O[0],x=O[1],m=Object(c.useState)(120),p=Object(k.a)(m,2),v=p[0],C=p[1],A=Object(c.useState)(40),w=Object(k.a)(A,2),y=w[0],D=w[1],E=Object(c.useCallback)((function(e){if(-1!==b.indexOf(e)){return{setActiveBox:function(t){o((function(n){return Object(s.a)(Object(s.a)({},n),{},Object(g.a)({},e,t))}))},setActiveBoxValues:function(t){j((function(n){return Object(s.a)(Object(s.a)({},n),{},Object(g.a)({},e,t))}))},setInstrument:function(t){x((function(n){return Object(s.a)(Object(s.a)({},n),{},Object(g.a)({},e,t))}))},setTempo:C,setGridLength:D}}return{setActiveBox:function(){},setActiveBoxValues:function(){},setInstrument:function(){}}}),[]);return Object(h.jsx)(re.Provider,{value:{getSetter:E,activeBoxes:a,activeBoxesValues:l,instruments:f,tempo:v,gridLength:y},children:t})},oe=function(e){var t=e.trackColor,n=void 0===t?"yellow":t,a=e.onPlay,o=e.trackName,u=void 0===o?"Track 1":o,l=e.trackNumber,j=Object(c.useContext)(re),b=j.getSetter,d=j.activeBoxes,O=j.activeBoxesValues,x=j.instruments,m=j.gridLength,p=j.tempo,C=Object(c.useMemo)((function(){return d[l]}),[d]),A=Object(c.useMemo)((function(){return O[l]}),[O]),w=Object(c.useMemo)((function(){return x[l]}),[x]),y=Object(c.useMemo)((function(){return b(l)}),[l]),D=y.setActiveBox,G=y.setActiveBoxValues,F=y.setInstrument,B=y.setTempo,S=y.setGridLength,M=Object(c.useState)(!1),T=Object(k.a)(M,2),L=T[0],Q=T[1];var Z=Object(c.useState)(Math.random()),te=Object(k.a)(Z,2),ne=te[0],ce=te[1],ae=Object(c.useMemo)((function(){return z[w]}),[w]),oe=Object(c.useRef)(!0),ie=function(){return ce(Math.random())},se=function(e){var t=e.split(E),n=Object(k.a)(t,2),c=n[0],r=n[1];return ae.length>parseInt(c,10)&&r<m};Object(c.useEffect)((function(){oe.current?oe.current=!1:ie()}),[C,A]),Object(c.useEffect)((function(){if(!oe.current){var e=C.filter(se),t=Object.keys(A).filter(se);D(e),G(t.map((function(e){return Object(g.a)({},e,A[e])})).reduce((function(e,t){return Object(s.a)(Object(s.a)({},e),t)}),{}))}}),[ae,m]);var ue="primary.".concat(n);return Object(h.jsxs)(R.a,{children:[Object(h.jsxs)(R.a,{direction:"row",alignItems:"flex-end",paddingBottom:2,spacing:5,children:[Object(h.jsxs)(R.a,{direction:"row",alignItems:"center",justifyContent:"flex-start",spacing:3,children:[Object(h.jsx)(i.b,{to:"/",children:Object(h.jsx)(V.a,{"aria-label":"back",sx:{color:ue},children:Object(h.jsx)(X.a,{})})}),Object(h.jsx)(W.a,{color:ue,variant:"h5",fontWeight:"bold",sx:{marginLeft:"14px"},children:u}),Object(h.jsx)(N.a,{onClick:function(){a(C.map((function(e){var t;return"".concat(e).concat(E).concat(null!==(t=A[e])&&void 0!==t?t:0)})),w,p,L)},sx:{backgroundColor:ue,marginLeft:"28px",marginRight:"14px","&:hover":{backgroundColor:ue}},children:"Play"}),Object(h.jsx)(N.a,{onClick:function(){D([]),G([])},variant:"outlined",sx:{color:ue,borderColor:ue},children:"Clear"}),Object(h.jsx)(P.a,{children:Object(h.jsx)(J.a,{control:Object(h.jsx)(U.a,{onChange:function(e){Q(e.target.checked)},sx:{color:ue,"&.Mui-checked":{color:ue}}}),sx:{color:ue},label:"Loop"})})]}),Object(h.jsxs)(R.a,{direction:"row",alignItems:"flex-end",spacing:1,children:[Object(h.jsxs)(f.a,{sx:{width:120},children:[Object(h.jsxs)(_.a,{id:"tempo",sx:{color:ue},children:["Tempo:"," ",p]}),Object(h.jsx)(H.a,{size:"small",value:p,id:"tempo",max:180,min:80,onChange:function(e,t){B(t)}})]}),Object(h.jsx)(f.a,{sx:{width:80},children:Object(h.jsxs)(Y.a,{size:"small",sx:{minWidth:80},children:[Object(h.jsxs)(_.a,{id:"grid-size",sx:{color:ue},children:["Grid length:",m]}),Object(h.jsx)(q.a,{labelId:"grid-size",id:"grid-size-input",value:m,label:"Grid length",autoWidth:!0,variant:"filled",onChange:function(e){return S(parseInt(e.target.value,10))},sx:{color:ue},children:[32,36,40,44,48,52].map((function(e){return Object(h.jsx)(K.a,{value:e,children:e},e)}))})]})}),Object(h.jsx)(f.a,{sx:{width:64},children:Object(h.jsxs)(Y.a,{size:"small",sx:{minWidth:80},children:[Object(h.jsx)(_.a,{id:"instrument",sx:{color:ue},children:"Instrument"}),Object(h.jsx)(q.a,{labelId:"instrument",id:"instrument-input",value:w,defaultValue:"piano",label:"Instrument",autoWidth:!0,variant:"filled",onChange:function(e){return F(e.target.value)},sx:{color:ue},children:I.map((function(e){return Object(h.jsx)(K.a,{value:e,children:e},e)}))})]})})]})]}),Object(h.jsx)(R.a,{spacing:.25,children:ae.map((function(e,t){return Object(h.jsxs)(R.a,{width:"fit-content",spacing:.25,direction:"row",alignItems:"center",sx:{borderWidth:1,borderStyle:"solid",borderColor:"transparent",borderRadius:.5,"&:hover":{borderColor:ue,transition:"200ms"}},children:[Object(h.jsx)(f.a,{height:24,width:50,display:"flex",alignItems:"center",justifyContent:"center",fontWeight:"bold",color:ue,children:e.replace("s","#")}),(n=m,Array.from(Array(n))).map((function(e,n){var c="".concat(t).concat(E).concat(n),a=A[c];return Object(h.jsx)(r.a.Fragment,{children:Object(h.jsx)(f.a,{width:24,height:24,borderRadius:.5,sx:{backgroundColor:"primary.dark","&:hover":{backgroundColor:"primary.main",opacity:[.9,.8,.7]}},onClick:function(){return e=c,void(C.includes(e)?(D(C.filter((function(t){return t!==e}))),G($()(A,[e]))):(D([].concat(Object(v.a)(C),[e])),G(Object(s.a)(Object(s.a)({},A),{},Object(g.a)({},e.toString(),1)))));var e},children:C.includes(c)&&a?Object(h.jsx)(ee.ResizableBox,{height:24,width:24*a+2*(a-1),axis:"x",handleSize:[10,10],onResizeStop:function(e,t){!function(e,t){var n=t.split(E),c=Object(k.a)(n,2),r=c[0],a=c[1];if(C.includes("".concat(r).concat(E).concat(parseInt(a,10)+1)))ie();else{var o=Math.floor(e/32)+(e%32>0?1:0),i=parseInt(a,10)+o-1;[C.includes(i),i>m].some(Boolean)?ie():G(Object(s.a)(Object(s.a)({},A),{},Object(g.a)({},t,o)))}}(t.size.width,c)},children:Object(h.jsx)(f.a,{bgcolor:ue,height:"100%",width:"100%",borderRadius:.5})}):null})},"col-".concat(n))}))]},"row-".concat(t));var n}))},ne)]})};oe.defaultProps={trackColor:"yellow",trackName:"Track 1"};var ie=oe,se=function(e){var t=e.trackNumber,n=Object(c.useState)(null),r=Object(k.a)(n,2),a=r[0],o=r[1],i=Object(c.useState)([]),u=Object(k.a)(i,2),l=u[0],j=u[1],b=Object(c.useState)(0),O=Object(k.a)(b,2),x=O[0],m=O[1],w=Object(c.useState)(!1),D=Object(k.a)(w,2),I=D[0],M=D[1],N=Object(c.useState)(-1),T=Object(k.a)(N,2),R=T[0],V=T[1],W=Object(c.useState)(!1),P=Object(k.a)(W,2),J=P[0],U=P[1],_=Object(c.useState)(!1),H=Object(k.a)(_,2),Y=H[0],q=H[1],K=d[t],Q=function(e,t){return[Math.floor(e/t),e%t]},X=function(e){var t=Q(e,G),n=Object(k.a)(t,2),c=n[0],r=n[1],a=Q(r,F),o=Object(k.a)(a,2),i=o[0],s=o[1],u=Q(s,B),l=Object(k.a)(u,2),j=l[0],b=l[1],d=Q(b,S);return{"1n":c,"2n":i,"4n":j,"8n":Object(k.a)(d,1)[0]}},Z=function(e){return A.b.toSeconds(e)},$=function(){M(!1),m(0),a.dispose(),A.b.cancel(x/1e3)},ee=function(e){U(!0),te(e)},te=function(e){M(!0),e.forEach((function(e){var t=e.note;e.noteDatas.forEach((function(e){var n=e.duration,c=e.start;a.triggerAttackRelease(t.replace("s","#"),n,"+"+Z(c))}))}));var t=setTimeout((function(){Y?ee(e):$()}),x+500);V(t)},ne=function(){var e=Object(C.a)(p.a.mark((function e(t,n,c,r){var a,i,u,l;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:q(r),A.b.bpm.value=c,a=t.map((function(e){var t=e.split(E),n=Object(k.a)(t,3),c=n[0],r=n[1],a=n[2];return{row:c,duration:X(a),start:X(r)}})),i=Object.entries(y()(a,(function(e){return e.row}))).map((function(e){var t=Object(k.a)(e,2),c=t[0],r=t[1];return{note:z[n][c],noteDatas:r}})),a.length>0&&(u=i.reduce((function(e,t){return Object(s.a)(Object(s.a)({},e),{},Object(g.a)({},t.note.replace("s","#").toString(),t.note+".mp3"))}),{}),l=new A.a({urls:u,baseUrl:"https://louisandrew.github.io/loop-maker/samples/"+n+"/",onload:function(){var e=Object(C.a)(p.a.mark((function e(){var t,n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Object(v.a)(a).map((function(e){return t=e.start,n=e.duration,1e3*(Z(t)+Z(n));var t,n})),n=t.sort((function(e,t){return t-e}))[0],m(n),j(i),o(l),e.next=7,A.c();case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}).toDestination());case 5:case"end":return e.stop()}}),e)})));return function(t,n,c,r){return e.apply(this,arguments)}}();return Object(c.useEffect)((function(){a&&l&&te(l)}),[a]),Object(c.useEffect)((function(){J&&setTimeout((function(){U(!1)}),100)}),[J]),Object(h.jsxs)(f.a,{children:[Object(h.jsx)(L,{onCancel:function(){-1!==R&&(clearTimeout(R),V(-1)),$()},trackColor:K,playDuration:x,display:I,reset:J}),Object(h.jsx)(ie,{trackColor:K,trackName:"Track "+t,trackNumber:t,onPlay:ne})]})},ue=function(e){var t=e.trackNumber;return Object(h.jsx)(f.a,{bgcolor:"primary.bg",display:"flex",alignItems:"center",justifyContent:"center",height:"100vh",children:Object(h.jsx)(se,{trackNumber:t})})},le=function(){return Object(h.jsxs)(O.c,{children:[Object(h.jsx)(O.a,{path:"/",element:Object(h.jsx)(x,{})}),b.map((function(e){return Object(h.jsx)(O.a,{path:"track-".concat(e),element:Object(h.jsx)(ue,{trackNumber:e})},"track-".concat(e))}))]})};var je=function(){var e=Object(u.a)({palette:{primary:Object(s.a)({},j)}});return Object(h.jsx)("div",{className:"App",children:Object(h.jsx)(l.a,{theme:e,children:Object(h.jsx)(ae,{children:Object(h.jsx)(le,{})})})})};o.a.render(Object(h.jsx)(i.a,{basename:"loop-maker",children:Object(h.jsx)(je,{})}),document.getElementById("root"))}},[[138,1,2]]]);
//# sourceMappingURL=main.7b0441e7.chunk.js.map