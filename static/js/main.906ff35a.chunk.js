(this["webpackJsonploop-maker"]=this["webpackJsonploop-maker"]||[]).push([[0],{112:function(e,t,n){},114:function(e,t,n){},138:function(e,t,n){"use strict";n.r(t);var c=n(0),r=n.n(c),a=n(33),i=n.n(a),o=n(43),s=(n(112),n(113),n(5)),u=n(101),l=n(191),j={main:"#646464",secondary:"#fff",bg:"#3E3C3C",dark:"#525151",light:"#706c6c",red:"#ea9191",yellow:"#E3EA91",blue:"#91b9ea",green:"#91eabb",white:"#ccc"},b=[1,2,3,4,5],O={1:"red",2:"yellow",3:"blue",4:"green",5:"white"},d=["B","A#","A","G#","G","F#","F","E","D#","D","C#","C"],f=(["C"].concat(d,d),"__"),p=8,h=4,x=2,m=1,v=["bass-electric","cello","flute","guitar-acoustic","guitar-electric","piano","saxophone","violin"],g={"bass-electric":["As5","G5","E5","Cs5","As4","G4","E4","Cs4","As3","G3","E3","Cs3","As2","G2","E2","Cs2"],cello:["B4","As4","A4","Gs4","G4","Fs4","F4","E4","Ds4","D4","Cs4","C4","B3","As3","A3","Gs3","G3","Fs3","F3","E3","Ds3","D3","Cs3","C3"],clarinet:["F2","D3","F3","D4","D5","F4","Fs5","As2","As3","As4","D2"],flute:["C6","A5","E5","C5","A4","E4","C4","A3","E3","C3"],"guitar-acoustic":["B3","As3","A3","Gs3","G3","Fs3","F3","E3","Ds3","D3","Cs3","C3","B2","As2","A2","Gs2","G2","Fs2","F2","E2","Ds2","D2","Cs2","C2"],"guitar-electric":["A5","Fs5","Ds5","C5","A4","Fs4","Ds4","C4","A3","Fs3","Ds3","C3"],harp:["B3","C5","D2","D4","D6","D7","E1","E3","E5","F2","F4","F6","F7","G1","G3","G5","A2","A4","A6","B1","B5","B6","C3"],piano:["C5","B4","As4","A4","Gs4","G4","Fs4","F4","E4","Ds4","D4","Cs4","C4","B3","As3","A3","Gs3","G3","Fs3","F3","E3","Ds3","D3","Cs3","C3"],saxophone:["B3","As3","A3","Gs3","G3","Fs3","F3","E3","Ds3","D3","Cs3","C3"],violin:["C6","A5","G5","E5","C5","A4","G4","E4","C4"]},C=(n(114),n(20)),y=n(192),k=n(190),A=n(6),w=n.n(A),D=n(16),E=n(7),G=n(8),S=n(53),B=n(96),F=n.n(B),I=n(4),M=b.reduce((function(e,t){return Object(s.a)(Object(s.a)({},e),{},Object(E.a)({},t,[]))}),{}),P=b.reduce((function(e,t){return Object(s.a)(Object(s.a)({},e),{},Object(E.a)({},t,{}))}),{}),z=b.reduce((function(e,t){return Object(s.a)(Object(s.a)({},e),{},Object(E.a)({},t,"piano"))}),{}),N=Object(c.createContext)({activeBoxes:M,activeBoxesValues:P,instruments:z,tempo:120,gridLength:40}),T=function(e){var t=e.children,n=Object(c.useState)(M),r=Object(G.a)(n,2),a=r[0],i=r[1],o=Object(c.useState)(P),u=Object(G.a)(o,2),l=u[0],j=u[1],O=Object(c.useState)(z),d=Object(G.a)(O,2),f=d[0],p=d[1],h=Object(c.useState)(120),x=Object(G.a)(h,2),m=x[0],v=x[1],g=Object(c.useState)(40),C=Object(G.a)(g,2),y=C[0],k=C[1],A=Object(c.useCallback)((function(e){if(-1!==b.indexOf(e)){return{setActiveBox:function(t){i((function(n){return Object(s.a)(Object(s.a)({},n),{},Object(E.a)({},e,t))}))},setActiveBoxValues:function(t){j((function(n){return Object(s.a)(Object(s.a)({},n),{},Object(E.a)({},e,t))}))},setInstrument:function(t){p((function(n){return Object(s.a)(Object(s.a)({},n),{},Object(E.a)({},e,t))}))},setTempo:v,setGridLength:k}}return{setActiveBox:function(){},setActiveBoxValues:function(){},setInstrument:function(){}}}),[]);return Object(I.jsx)(N.Provider,{value:{getSetter:A,activeBoxes:a,activeBoxesValues:l,instruments:f,tempo:m,gridLength:y},children:t})},L=function(){return Object(c.useContext)(N)},V=function(e,t){return[Math.floor(e/t),e%t]},R=function(e){var t=V(e,p),n=Object(G.a)(t,2),c=n[0],r=n[1],a=V(r,h),i=Object(G.a)(a,2),o=i[0],s=i[1],u=V(s,x),l=Object(G.a)(u,2),j=l[0],b=l[1],O=V(b,m);return{"1n":c,"2n":o,"4n":j,"8n":Object(G.a)(O,1)[0]}},W=function(e){return S.b.toSeconds(e)},J=Object(c.createContext)({playDuration:0,displayOverlay:!1,resetProgress:!1,cancelPlayAudio:function(){},play:function(){},playSingleAudio:function(){},playMultipleAudio:function(){}}),U=b.reduce((function(e,t){return Object(s.a)(Object(s.a)({},e),{},Object(E.a)({},t,null))}),{}),_=b.reduce((function(e,t){return Object(s.a)(Object(s.a)({},e),{},Object(E.a)({},t,!1))}),{}),H=function(e){return"string"===typeof e&&e.includes(f)},Y=function(e){var t=e.children,n=L(),r=n.tempo,a=n.gridLength,i=n.activeBoxes,o=n.activeBoxesValues,u=n.instruments,l=Object(c.useState)(""),j=Object(G.a)(l,2),b=j[0],O=j[1],d=Object(c.useState)(U),p=Object(G.a)(d,2),h=p[0],x=p[1],m=Object(c.useState)(_),v=Object(G.a)(m,2),C=v[0],y=v[1],k=Object(c.useState)(U),A=Object(G.a)(k,2),B=A[0],M=A[1],P=Object(c.useState)(0),z=Object(G.a)(P,2),N=z[0],T=z[1],V=Object(c.useState)(!1),Y=Object(G.a)(V,2),q=Y[0],K=Y[1],Q=Object(c.useState)(-1),X=Object(G.a)(Q,2),Z=X[0],$=X[1],ee=Object(c.useState)(!1),te=Object(G.a)(ee,2),ne=te[0],ce=te[1],re=Object(c.useState)(!1),ae=Object(G.a)(re,2),ie=ae[0],oe=ae[1],se=function(e){if(N>0){if(K(!1),T(0),S.b.cancel(N/1e3),e&&!H(b))e.dispose(),x((function(e){return Object(s.a)(Object(s.a)({},e),{},Object(E.a)({},b,null))})),y((function(e){return Object(s.a)(Object(s.a)({},e),{},Object(E.a)({},b,!1))}));else b.split(f).forEach((function(e){h[e].dispose()})),x(U),y(_);O("")}},ue=function(e,t){ce(!0),le(e,t)},le=function(e,t){K(!0),e.forEach((function(e){var n=e.note;e.noteDatas.forEach((function(e){var c=e.duration,r=e.start;t.triggerAttackRelease(n.replace("s","#"),c,"+"+W(r))}))}));var n=setTimeout((function(){ie?ue(e,t):se(H(b)?null:t)}),N+500);$(n)},je=function(e){return i[e].map((function(t){var n;return"".concat(t).concat(f).concat(null!==(n=o[e][t])&&void 0!==n?n:0)}))},be=function(){var e=Object(D.a)(w.a.mark((function e(t){var n,c,a,i,o;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(S.b.bpm.value=r,n=u[t],c=je(t).map((function(e){var t=e.split(f),n=Object(G.a)(t,3),c=n[0],r=n[1],a=n[2];return{row:c,duration:R(a),start:R(r)}})),a=Object.entries(F()(c,(function(e){return e.row}))).map((function(e){var t=Object(G.a)(e,2),c=t[0],r=t[1];return{note:g[n][c],noteDatas:r}})),!(c.length>0)){e.next=8;break}return i=a.reduce((function(e,t){return Object(s.a)(Object(s.a)({},e),{},Object(E.a)({},t.note.replace("s","#").toString(),t.note+".mp3"))}),{}),o=new S.a({urls:i,baseUrl:"https://louisandrew.github.io/loop-maker/samples/"+n+"/",onload:function(){var e=Object(D.a)(w.a.mark((function e(){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return M((function(e){return Object(s.a)(Object(s.a)({},e),{},Object(E.a)({},t,a))})),y((function(e){return Object(s.a)(Object(s.a)({},e),{},Object(E.a)({},t,!0))})),e.next=4,S.c();case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}).toDestination(),e.abrupt("return",o);case 8:return e.abrupt("return",null);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Oe=function(){var e=Object(D.a)(w.a.mark((function e(t,n){var c,r;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=1e3*W(R(a)),T(c),O(t),oe(n),e.next=6,be(t);case 6:r=e.sent,x((function(e){return Object(s.a)(Object(s.a)({},e),{},Object(E.a)({},t,r))}));case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),de=function(){var e=Object(D.a)(w.a.mark((function e(t){var n,c,r;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object.keys(o).filter((function(e){return Object.values(o[e]).length>0})),O(n.length>0?n.join(f):""),c=1e3*W(R(a)),T(c),oe(t),e.next=7,Promise.all(n.map(function(){var e=Object(D.a)(w.a.mark((function e(t){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=E.a,e.t1={},e.t2=t,e.next=5,be(t);case 5:return e.t3=e.sent,e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t3));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 7:r=e.sent,x((function(e){return Object(s.a)(Object(s.a)({},e),r.reduce((function(e,t){return Object(s.a)(Object(s.a)({},e),t)}),{}))}));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),fe=function(e){return C[e]&&h[e]};return Object(c.useEffect)((function(){ne&&setTimeout((function(){ce(!1)}),100)}),[ne]),Object(c.useEffect)((function(){if(H(b)){var e=b.split(f);e.every(fe)&&e.forEach((function(e){le(B[e],h[e])}))}else fe(b)&&le(B[b],h[b])}),[C,h]),Object(I.jsx)(J.Provider,{value:{displayOverlay:q,playDuration:N,resetProgress:ne,play:be,cancelPlayAudio:function(){-1!==Z&&(clearTimeout(Z),$(-1)),se(H(b)?null:h[b])},playSingleAudio:Oe,playMultipleAudio:de},children:t})},q=function(){return Object(c.useContext)(J)},K=function(){var e=q(),t=e.playMultipleAudio,n=e.displayOverlay,c=e.playSingleAudio;return Object(I.jsxs)("div",{children:[Object(I.jsx)("h1",{children:"Home View"}),b.map((function(e){return Object(I.jsxs)("div",{children:[Object(I.jsx)(o.b,{to:"track-".concat(e),children:Object(I.jsxs)(y.a,{children:["Go to track"," ",e]})},"track-".concat(e,"-link")),Object(I.jsx)(k.a,{onClick:function(){return c(e,!1)},children:"play track"})]})})),n&&Object(I.jsx)(y.a,{children:"Displaying overlay"}),Object(I.jsx)(k.a,{onClick:t,children:"Multiple audio"})]})},Q=n(193),X=function(e){var t=e.playDuration,n=e.trackColor,r=e.display,a=e.onCancel,i=e.reset,o=Object(c.useState)(Math.random()),s=Object(G.a)(o,2),u=s[0],l=s[1],j=Object(c.useState)(0),b=Object(G.a)(j,2),O=b[0],d=b[1],f=0!==t&&r,p=function(){d(0),l(Math.random())};Object(c.useEffect)((function(){var e;return i&&p(),t>0?e=setInterval((function(){d((function(e){return 100===e?e:e+1}))}),t/100):p(),function(){e&&(p(),clearInterval(e))}}),[t,r,i]);var h="primary.".concat(n);return f?Object(I.jsxs)(y.a,{position:"absolute",bgcolor:"rgba(0, 0, 0, 0.1)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",sx:{backdropFilter:"blur(1px)",zIndex:99,top:0,left:0,right:0,bottom:0},children:[Object(I.jsx)(y.a,{color:"#fff",fontWeight:"bold",fontSize:"32px",children:"PLAYING AUDIO"}),Object(I.jsx)(y.a,{width:"20vw",color:h,sx:{marginTop:3},children:Object(I.jsx)(Q.a,{color:"inherit",variant:"determinate",value:O},u)}),Object(I.jsx)(k.a,{onClick:a,variant:"outlined",sx:{color:h,borderColor:h,marginTop:4},children:"Cancel"})]}):null};X.defaultProps={trackColor:"yellow",onCancel:function(){}};var Z=X,$=n(15),ee=n(180),te=n(194),ne=n(195),ce=n(196),re=n(197),ae=n(185),ie=n(188),oe=n(186),se=n(198),ue=n(183),le=n(187),je=n(100),be=n.n(je),Oe=n(98),de=n.n(Oe),fe=n(99),pe=function(e){var t=e.trackColor,n=void 0===t?"yellow":t,a=e.onPlay,i=e.trackName,u=void 0===i?"Track 1":i,l=e.trackNumber,j=L(),b=j.getSetter,O=j.activeBoxes,d=j.activeBoxesValues,p=j.instruments,h=j.gridLength,x=j.tempo,m=Object(c.useMemo)((function(){return O[l]}),[O]),C=Object(c.useMemo)((function(){return d[l]}),[d]),A=Object(c.useMemo)((function(){return p[l]}),[p]),w=Object(c.useMemo)((function(){return b(l)}),[l]),D=w.setActiveBox,S=w.setActiveBoxValues,B=w.setInstrument,F=w.setTempo,M=w.setGridLength,P=Object(c.useState)(!1),z=Object(G.a)(P,2),N=z[0],T=z[1];var V=Object(c.useState)(Math.random()),R=Object(G.a)(V,2),W=R[0],J=R[1],U=Object(c.useMemo)((function(){return g[A]}),[A]),_=Object(c.useRef)(!0),H=function(){return J(Math.random())},Y=function(e){var t=e.split(f),n=Object(G.a)(t,2),c=n[0],r=n[1];return U.length>parseInt(c,10)&&r<h};Object(c.useEffect)((function(){_.current?_.current=!1:H()}),[m,C]),Object(c.useEffect)((function(){if(!_.current){var e=m.filter(Y),t=Object.keys(C).filter(Y);D(e),S(t.map((function(e){return Object(E.a)({},e,C[e])})).reduce((function(e,t){return Object(s.a)(Object(s.a)({},e),t)}),{}))}}),[U,h]);var q="primary.".concat(n);return Object(I.jsxs)(ee.a,{children:[Object(I.jsxs)(ee.a,{direction:"row",alignItems:"flex-end",paddingBottom:2,spacing:5,children:[Object(I.jsxs)(ee.a,{direction:"row",alignItems:"center",justifyContent:"flex-start",spacing:3,children:[Object(I.jsx)(o.b,{to:"/",children:Object(I.jsx)(te.a,{"aria-label":"back",sx:{color:q},children:Object(I.jsx)(be.a,{})})}),Object(I.jsx)(ne.a,{color:q,variant:"h5",fontWeight:"bold",sx:{marginLeft:"14px"},children:u}),Object(I.jsx)(k.a,{onClick:function(){a(l,N)},sx:{backgroundColor:q,marginLeft:"28px",marginRight:"14px","&:hover":{backgroundColor:q}},children:"Play"}),Object(I.jsx)(k.a,{onClick:function(){D([]),S([])},variant:"outlined",sx:{color:q,borderColor:q},children:"Clear"}),Object(I.jsx)(ce.a,{children:Object(I.jsx)(re.a,{control:Object(I.jsx)(ae.a,{onChange:function(e){T(e.target.checked)},sx:{color:q,"&.Mui-checked":{color:q}}}),sx:{color:q},label:"Loop"})})]}),Object(I.jsxs)(ee.a,{direction:"row",alignItems:"flex-end",spacing:1,children:[Object(I.jsxs)(y.a,{sx:{width:120},children:[Object(I.jsxs)(ie.a,{id:"tempo",sx:{color:q},children:["Tempo:"," ",x]}),Object(I.jsx)(oe.a,{size:"small",value:x,id:"tempo",max:180,min:80,onChange:function(e,t){F(t)}})]}),Object(I.jsx)(y.a,{sx:{width:80},children:Object(I.jsxs)(se.a,{size:"small",sx:{minWidth:80},children:[Object(I.jsxs)(ie.a,{id:"grid-size",sx:{color:q},children:["Grid length:",h]}),Object(I.jsx)(ue.a,{labelId:"grid-size",id:"grid-size-input",value:h,label:"Grid length",autoWidth:!0,variant:"filled",onChange:function(e){return M(parseInt(e.target.value,10))},sx:{color:q},children:[32,36,40,44,48,52].map((function(e){return Object(I.jsx)(le.a,{value:e,children:e},e)}))})]})}),Object(I.jsx)(y.a,{sx:{width:64},children:Object(I.jsxs)(se.a,{size:"small",sx:{minWidth:80},children:[Object(I.jsx)(ie.a,{id:"instrument",sx:{color:q},children:"Instrument"}),Object(I.jsx)(ue.a,{labelId:"instrument",id:"instrument-input",value:A,defaultValue:"piano",label:"Instrument",autoWidth:!0,variant:"filled",onChange:function(e){return B(e.target.value)},sx:{color:q},children:v.map((function(e){return Object(I.jsx)(le.a,{value:e,children:e},e)}))})]})})]})]}),Object(I.jsx)(ee.a,{spacing:.25,children:U.map((function(e,t){return Object(I.jsxs)(ee.a,{width:"fit-content",spacing:.25,direction:"row",alignItems:"center",sx:{borderWidth:1,borderStyle:"solid",borderColor:"transparent",borderRadius:.5,"&:hover":{borderColor:q,transition:"200ms"}},children:[Object(I.jsx)(y.a,{height:24,width:50,display:"flex",alignItems:"center",justifyContent:"center",fontWeight:"bold",color:q,children:e.replace("s","#")}),(n=h,Array.from(Array(n))).map((function(e,n){var c="".concat(t).concat(f).concat(n),a=C[c];return Object(I.jsx)(r.a.Fragment,{children:Object(I.jsx)(y.a,{width:24,height:24,borderRadius:.5,sx:{backgroundColor:"primary.dark","&:hover":{backgroundColor:"primary.main",opacity:[.9,.8,.7]}},onClick:function(){return e=c,void(m.includes(e)?(D(m.filter((function(t){return t!==e}))),S(de()(C,[e]))):(D([].concat(Object($.a)(m),[e])),S(Object(s.a)(Object(s.a)({},C),{},Object(E.a)({},e.toString(),1)))));var e},children:m.includes(c)&&a?Object(I.jsx)(fe.ResizableBox,{height:24,width:24*a+2*(a-1),axis:"x",handleSize:[10,10],onResizeStop:function(e,t){!function(e,t){var n=t.split(f),c=Object(G.a)(n,2),r=c[0],a=c[1];if(m.includes("".concat(r).concat(f).concat(parseInt(a,10)+1)))H();else{var i=Math.floor(e/32)+(e%32>0?1:0),o=parseInt(a,10)+i-1;[m.includes(o),o>h].some(Boolean)?H():S(Object(s.a)(Object(s.a)({},C),{},Object(E.a)({},t,i)))}}(t.size.width,c)},children:Object(I.jsx)(y.a,{bgcolor:q,height:"100%",width:"100%",borderRadius:.5})}):null})},"col-".concat(n))}))]},"row-".concat(t));var n}))},W)]})};pe.defaultProps={trackColor:"yellow",trackName:"Track 1"};var he=pe,xe=function(e){var t=e.trackNumber,n=q(),c=n.cancelPlayAudio,r=n.playDuration,a=n.displayOverlay,i=n.resetProgress,o=n.playSingleAudio,s=O[t];return Object(I.jsxs)(y.a,{children:[Object(I.jsx)(Z,{onCancel:c,trackColor:s,playDuration:r,display:a,reset:i}),Object(I.jsx)(he,{trackColor:s,trackName:"Track ".concat(t),trackNumber:t,onPlay:o})]})},me=function(e){var t=e.trackNumber;return Object(I.jsx)(y.a,{bgcolor:"primary.bg",display:"flex",alignItems:"center",justifyContent:"center",height:"100vh",children:Object(I.jsx)(xe,{trackNumber:t})})},ve=function(){return Object(I.jsxs)(C.c,{children:[Object(I.jsx)(C.a,{path:"/",element:Object(I.jsx)(K,{})}),b.map((function(e){return Object(I.jsx)(C.a,{path:"track-".concat(e),element:Object(I.jsx)(me,{trackNumber:e})},"track-".concat(e))}))]})};var ge=function(){var e=Object(u.a)({palette:{primary:Object(s.a)({},j)}});return Object(I.jsx)("div",{className:"App",children:Object(I.jsx)(l.a,{theme:e,children:Object(I.jsx)(T,{children:Object(I.jsx)(Y,{children:Object(I.jsx)(ve,{})})})})})};i.a.render(Object(I.jsx)(o.a,{basename:"loop-maker",children:Object(I.jsx)(ge,{})}),document.getElementById("root"))}},[[138,1,2]]]);
//# sourceMappingURL=main.906ff35a.chunk.js.map