(this["webpackJsonploop-maker"]=this["webpackJsonploop-maker"]||[]).push([[0],{112:function(e,t,n){},114:function(e,t,n){},138:function(e,t,n){"use strict";n.r(t);var c=n(0),r=n.n(c),a=n(33),i=n.n(a),o=n(43),s=(n(112),n(113),n(5)),u=n(101),l=n(191),j={main:"#646464",secondary:"#fff",bg:"#3E3C3C",dark:"#525151",light:"#706c6c",red:"#ea9191",yellow:"#E3EA91",blue:"#91b9ea",green:"#91eabb",white:"#ccc"},b=[1,2,3,4,5],O={1:"red",2:"yellow",3:"blue",4:"green",5:"white"},d=["B","A#","A","G#","G","F#","F","E","D#","D","C#","C"],f=(["C"].concat(d,d),"__"),p=8,h=4,x=2,m=1,v=["bass-electric","cello","flute","guitar-acoustic","guitar-electric","piano","saxophone","violin"],g={"bass-electric":["As5","G5","E5","Cs5","As4","G4","E4","Cs4","As3","G3","E3","Cs3","As2","G2","E2","Cs2"],cello:["B4","As4","A4","Gs4","G4","Fs4","F4","E4","Ds4","D4","Cs4","C4","B3","As3","A3","Gs3","G3","Fs3","F3","E3","Ds3","D3","Cs3","C3"],clarinet:["F2","D3","F3","D4","D5","F4","Fs5","As2","As3","As4","D2"],flute:["C6","A5","E5","C5","A4","E4","C4","A3","E3","C3"],"guitar-acoustic":["B3","As3","A3","Gs3","G3","Fs3","F3","E3","Ds3","D3","Cs3","C3","B2","As2","A2","Gs2","G2","Fs2","F2","E2","Ds2","D2","Cs2","C2"],"guitar-electric":["A5","Fs5","Ds5","C5","A4","Fs4","Ds4","C4","A3","Fs3","Ds3","C3"],harp:["B3","C5","D2","D4","D6","D7","E1","E3","E5","F2","F4","F6","F7","G1","G3","G5","A2","A4","A6","B1","B5","B6","C3"],piano:["C5","B4","As4","A4","Gs4","G4","Fs4","F4","E4","Ds4","D4","Cs4","C4","B3","As3","A3","Gs3","G3","Fs3","F3","E3","Ds3","D3","Cs3","C3"],saxophone:["B3","As3","A3","Gs3","G3","Fs3","F3","E3","Ds3","D3","Cs3","C3"],violin:["C6","A5","G5","E5","C5","A4","G4","E4","C4"]},C=(n(114),n(20)),y=n(192),k=n(190),A=n(6),w=n.n(A),D=n(16),E=n(15),G=n(7),S=n(8),B=n(53),F=n(96),I=n.n(F),P=n(4),M=b.reduce((function(e,t){return Object(s.a)(Object(s.a)({},e),{},Object(G.a)({},t,[]))}),{}),z=b.reduce((function(e,t){return Object(s.a)(Object(s.a)({},e),{},Object(G.a)({},t,{}))}),{}),N=b.reduce((function(e,t){return Object(s.a)(Object(s.a)({},e),{},Object(G.a)({},t,"piano"))}),{}),T=Object(c.createContext)({activeBoxes:M,activeBoxesValues:z,instruments:N,tempo:120,gridLength:40}),L=function(e){var t=e.children,n=Object(c.useState)(M),r=Object(S.a)(n,2),a=r[0],i=r[1],o=Object(c.useState)(z),u=Object(S.a)(o,2),l=u[0],j=u[1],O=Object(c.useState)(N),d=Object(S.a)(O,2),f=d[0],p=d[1],h=Object(c.useState)(120),x=Object(S.a)(h,2),m=x[0],v=x[1],g=Object(c.useState)(40),C=Object(S.a)(g,2),y=C[0],k=C[1],A=Object(c.useCallback)((function(e){if(-1!==b.indexOf(e)){return{setActiveBox:function(t){i((function(n){return Object(s.a)(Object(s.a)({},n),{},Object(G.a)({},e,t))}))},setActiveBoxValues:function(t){j((function(n){return Object(s.a)(Object(s.a)({},n),{},Object(G.a)({},e,t))}))},setInstrument:function(t){p((function(n){return Object(s.a)(Object(s.a)({},n),{},Object(G.a)({},e,t))}))},setTempo:v,setGridLength:k}}return{setActiveBox:function(){},setActiveBoxValues:function(){},setInstrument:function(){}}}),[]);return Object(P.jsx)(T.Provider,{value:{getSetter:A,activeBoxes:a,activeBoxesValues:l,instruments:f,tempo:m,gridLength:y},children:t})},V=function(){return Object(c.useContext)(T)},R=function(e,t){return[Math.floor(e/t),e%t]},W=function(e){var t=R(e,p),n=Object(S.a)(t,2),c=n[0],r=n[1],a=R(r,h),i=Object(S.a)(a,2),o=i[0],s=i[1],u=R(s,x),l=Object(S.a)(u,2),j=l[0],b=l[1],O=R(b,m);return{"1n":c,"2n":o,"4n":j,"8n":Object(S.a)(O,1)[0]}},J=function(e){return B.b.toSeconds(e)},U=Object(c.createContext)({playDuration:0,displayOverlay:!1,resetProgress:!1,cancelPlayAudio:function(){},play:function(){},playSingleAudio:function(){},playMultipleAudio:function(){}}),_=b.reduce((function(e,t){return Object(s.a)(Object(s.a)({},e),{},Object(G.a)({},t,null))}),{}),H=b.reduce((function(e,t){return Object(s.a)(Object(s.a)({},e),{},Object(G.a)({},t,!1))}),{}),Y=function(e){return"string"===typeof e&&e.includes(f)},q=function(e){var t=e.children,n=V(),r=n.tempo,a=n.gridLength,i=n.activeBoxes,o=n.activeBoxesValues,u=n.instruments,l=Object(c.useState)(""),j=Object(S.a)(l,2),b=j[0],O=j[1],d=Object(c.useState)(_),p=Object(S.a)(d,2),h=p[0],x=p[1],m=Object(c.useState)(H),v=Object(S.a)(m,2),C=v[0],y=v[1],k=Object(c.useState)(_),A=Object(S.a)(k,2),F=A[0],M=A[1],z=Object(c.useState)(0),N=Object(S.a)(z,2),T=N[0],L=N[1],R=Object(c.useState)(!1),q=Object(S.a)(R,2),K=q[0],Q=q[1],X=Object(c.useState)([]),Z=Object(S.a)(X,2),$=Z[0],ee=Z[1],te=Object(c.useState)(!1),ne=Object(S.a)(te,2),ce=ne[0],re=ne[1],ae=Object(c.useState)(!1),ie=Object(S.a)(ae,2),oe=ie[0],se=ie[1],ue=function(e){if(T>0){if(Q(!1),L(0),B.b.cancel(T/1e3),e&&!Y(b))e.dispose(),x((function(e){return Object(s.a)(Object(s.a)({},e),{},Object(G.a)({},b,null))})),y((function(e){return Object(s.a)(Object(s.a)({},e),{},Object(G.a)({},b,!1))}));else b.split(f).forEach((function(e){h[e].dispose()})),x(_),y(H);O("")}},le=function(e,t){re(!0),je(e,t)},je=function(e,t){Q(!0),e.forEach((function(e){var n=e.note;e.noteDatas.forEach((function(e){var c=e.duration,r=e.start;t.triggerAttackRelease(n.replace("s","#"),c,"+"+J(r))}))}));var n=setTimeout((function(){oe?le(e,t):ue(Y(b)?null:t)}),T+500);ee((function(e){return[].concat(Object(E.a)(e),[n])}))},be=function(e){return i[e].map((function(t){var n;return"".concat(t).concat(f).concat(null!==(n=o[e][t])&&void 0!==n?n:0)}))},Oe=function(){var e=Object(D.a)(w.a.mark((function e(t){var n,c,a,i,o;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(B.b.bpm.value=r,n=u[t],c=be(t).map((function(e){var t=e.split(f),n=Object(S.a)(t,3),c=n[0],r=n[1],a=n[2];return{row:c,duration:W(a),start:W(r)}})),a=Object.entries(I()(c,(function(e){return e.row}))).map((function(e){var t=Object(S.a)(e,2),c=t[0],r=t[1];return{note:g[n][c],noteDatas:r}})),!(c.length>0)){e.next=8;break}return i=a.reduce((function(e,t){return Object(s.a)(Object(s.a)({},e),{},Object(G.a)({},t.note.replace("s","#").toString(),t.note+".mp3"))}),{}),o=new B.a({urls:i,baseUrl:"https://louisandrew.github.io/loop-maker/samples/"+n+"/",onload:function(){var e=Object(D.a)(w.a.mark((function e(){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return M((function(e){return Object(s.a)(Object(s.a)({},e),{},Object(G.a)({},t,a))})),y((function(e){return Object(s.a)(Object(s.a)({},e),{},Object(G.a)({},t,!0))})),e.next=4,B.c();case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}).toDestination(),e.abrupt("return",o);case 8:return e.abrupt("return",null);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),de=function(){var e=Object(D.a)(w.a.mark((function e(t,n){var c,r;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=1e3*J(W(a)),L(c),O(t),se(n),e.next=6,Oe(t);case 6:r=e.sent,x((function(e){return Object(s.a)(Object(s.a)({},e),{},Object(G.a)({},t,r))}));case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),fe=function(){var e=Object(D.a)(w.a.mark((function e(t){var n,c,r;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object.keys(o).filter((function(e){return Object.values(o[e]).length>0})),O(n.length>0?n.join(f):""),c=1e3*J(W(a)),L(c),se(t),e.next=7,Promise.all(n.map(function(){var e=Object(D.a)(w.a.mark((function e(t){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=G.a,e.t1={},e.t2=t,e.next=5,Oe(t);case 5:return e.t3=e.sent,e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t3));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 7:r=e.sent,x((function(e){return Object(s.a)(Object(s.a)({},e),r.reduce((function(e,t){return Object(s.a)(Object(s.a)({},e),t)}),{}))}));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),pe=function(e){return C[e]&&h[e]};return Object(c.useEffect)((function(){ce&&setTimeout((function(){re(!1)}),100)}),[ce]),Object(c.useEffect)((function(){if(Y(b)){var e=b.split(f);e.every(pe)&&e.forEach((function(e){je(F[e],h[e])}))}else pe(b)&&je(F[b],h[b])}),[C,h]),Object(P.jsx)(U.Provider,{value:{displayOverlay:K,playDuration:T,resetProgress:ce,play:Oe,cancelPlayAudio:function(){$.length>0&&($.forEach((function(e){clearTimeout(e)})),ee([])),ue(Y(b)?null:h[b])},playSingleAudio:de,playMultipleAudio:fe},children:t})},K=function(){return Object(c.useContext)(U)},Q=n(193),X=function(e){var t=e.playDuration,n=e.trackColor,r=e.display,a=e.onCancel,i=e.reset,o=Object(c.useState)(Math.random()),s=Object(S.a)(o,2),u=s[0],l=s[1],j=Object(c.useState)(0),b=Object(S.a)(j,2),O=b[0],d=b[1],f=0!==t&&r,p=function(){d(0),l(Math.random())};Object(c.useEffect)((function(){var e;return i&&p(),t>0?e=setInterval((function(){d((function(e){return 100===e?e:e+1}))}),t/100):p(),function(){e&&(p(),clearInterval(e))}}),[t,r,i]);var h="primary.".concat(n);return f?Object(P.jsxs)(y.a,{position:"absolute",bgcolor:"rgba(0, 0, 0, 0.1)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",sx:{backdropFilter:"blur(1px)",zIndex:99,top:0,left:0,right:0,bottom:0},children:[Object(P.jsx)(y.a,{color:"#fff",fontWeight:"bold",fontSize:"32px",children:"PLAYING AUDIO"}),Object(P.jsx)(y.a,{width:"20vw",color:h,sx:{marginTop:3},children:Object(P.jsx)(Q.a,{color:"inherit",variant:"determinate",value:O},u)}),Object(P.jsx)(k.a,{onClick:a,variant:"outlined",sx:{color:h,borderColor:h,marginTop:4},children:"Cancel"})]}):null};X.defaultProps={trackColor:"yellow",onCancel:function(){}};var Z=X,$=function(){var e=K(),t=e.playMultipleAudio,n=e.displayOverlay,c=e.playDuration,r=e.cancelPlayAudio,a=e.resetProgress,i=e.playSingleAudio;return Object(P.jsxs)("div",{children:[Object(P.jsx)("h1",{children:"Home View"}),b.map((function(e){return Object(P.jsxs)("div",{children:[Object(P.jsx)(o.b,{to:"track-".concat(e),children:Object(P.jsxs)(y.a,{children:["Go to track"," ",e]})},"track-".concat(e,"-link")),Object(P.jsx)(k.a,{onClick:function(){return i(e,!1)},children:"play track"})]})})),Object(P.jsx)(Z,{playDuration:c,onCancel:r,trackColor:"white",display:n,reset:a}),Object(P.jsx)(k.a,{onClick:function(){return t(!1)},children:"Multiple audio"})]})},ee=n(180),te=n(194),ne=n(195),ce=n(196),re=n(197),ae=n(185),ie=n(188),oe=n(186),se=n(198),ue=n(183),le=n(187),je=n(100),be=n.n(je),Oe=n(98),de=n.n(Oe),fe=n(99),pe=function(e){var t=e.trackColor,n=void 0===t?"yellow":t,a=e.onPlay,i=e.trackName,u=void 0===i?"Track 1":i,l=e.trackNumber,j=V(),b=j.getSetter,O=j.activeBoxes,d=j.activeBoxesValues,p=j.instruments,h=j.gridLength,x=j.tempo,m=Object(c.useMemo)((function(){return O[l]}),[O]),C=Object(c.useMemo)((function(){return d[l]}),[d]),A=Object(c.useMemo)((function(){return p[l]}),[p]),w=Object(c.useMemo)((function(){return b(l)}),[l]),D=w.setActiveBox,B=w.setActiveBoxValues,F=w.setInstrument,I=w.setTempo,M=w.setGridLength,z=Object(c.useState)(!1),N=Object(S.a)(z,2),T=N[0],L=N[1];var R=Object(c.useState)(Math.random()),W=Object(S.a)(R,2),J=W[0],U=W[1],_=Object(c.useMemo)((function(){return g[A]}),[A]),H=Object(c.useRef)(!0),Y=function(){return U(Math.random())},q=function(e){var t=e.split(f),n=Object(S.a)(t,2),c=n[0],r=n[1];return _.length>parseInt(c,10)&&r<h};Object(c.useEffect)((function(){H.current?H.current=!1:Y()}),[m,C]),Object(c.useEffect)((function(){if(!H.current){var e=m.filter(q),t=Object.keys(C).filter(q);D(e),B(t.map((function(e){return Object(G.a)({},e,C[e])})).reduce((function(e,t){return Object(s.a)(Object(s.a)({},e),t)}),{}))}}),[_,h]);var K="primary.".concat(n);return Object(P.jsxs)(ee.a,{children:[Object(P.jsxs)(ee.a,{direction:"row",alignItems:"flex-end",paddingBottom:2,spacing:5,children:[Object(P.jsxs)(ee.a,{direction:"row",alignItems:"center",justifyContent:"flex-start",spacing:3,children:[Object(P.jsx)(o.b,{to:"/",children:Object(P.jsx)(te.a,{"aria-label":"back",sx:{color:K},children:Object(P.jsx)(be.a,{})})}),Object(P.jsx)(ne.a,{color:K,variant:"h5",fontWeight:"bold",sx:{marginLeft:"14px"},children:u}),Object(P.jsx)(k.a,{onClick:function(){a(l,T)},sx:{backgroundColor:K,marginLeft:"28px",marginRight:"14px","&:hover":{backgroundColor:K}},children:"Play"}),Object(P.jsx)(k.a,{onClick:function(){D([]),B([])},variant:"outlined",sx:{color:K,borderColor:K},children:"Clear"}),Object(P.jsx)(ce.a,{children:Object(P.jsx)(re.a,{control:Object(P.jsx)(ae.a,{onChange:function(e){L(e.target.checked)},sx:{color:K,"&.Mui-checked":{color:K}}}),sx:{color:K},label:"Loop"})})]}),Object(P.jsxs)(ee.a,{direction:"row",alignItems:"flex-end",spacing:1,children:[Object(P.jsxs)(y.a,{sx:{width:120},children:[Object(P.jsxs)(ie.a,{id:"tempo",sx:{color:K},children:["Tempo:"," ",x]}),Object(P.jsx)(oe.a,{size:"small",value:x,id:"tempo",max:180,min:80,onChange:function(e,t){I(t)}})]}),Object(P.jsx)(y.a,{sx:{width:80},children:Object(P.jsxs)(se.a,{size:"small",sx:{minWidth:80},children:[Object(P.jsxs)(ie.a,{id:"grid-size",sx:{color:K},children:["Grid length:",h]}),Object(P.jsx)(ue.a,{labelId:"grid-size",id:"grid-size-input",value:h,label:"Grid length",autoWidth:!0,variant:"filled",onChange:function(e){return M(parseInt(e.target.value,10))},sx:{color:K},children:[32,36,40,44,48,52].map((function(e){return Object(P.jsx)(le.a,{value:e,children:e},e)}))})]})}),Object(P.jsx)(y.a,{sx:{width:64},children:Object(P.jsxs)(se.a,{size:"small",sx:{minWidth:80},children:[Object(P.jsx)(ie.a,{id:"instrument",sx:{color:K},children:"Instrument"}),Object(P.jsx)(ue.a,{labelId:"instrument",id:"instrument-input",value:A,defaultValue:"piano",label:"Instrument",autoWidth:!0,variant:"filled",onChange:function(e){return F(e.target.value)},sx:{color:K},children:v.map((function(e){return Object(P.jsx)(le.a,{value:e,children:e},e)}))})]})})]})]}),Object(P.jsx)(ee.a,{spacing:.25,children:_.map((function(e,t){return Object(P.jsxs)(ee.a,{width:"fit-content",spacing:.25,direction:"row",alignItems:"center",sx:{borderWidth:1,borderStyle:"solid",borderColor:"transparent",borderRadius:.5,"&:hover":{borderColor:K,transition:"200ms"}},children:[Object(P.jsx)(y.a,{height:24,width:50,display:"flex",alignItems:"center",justifyContent:"center",fontWeight:"bold",color:K,children:e.replace("s","#")}),(n=h,Array.from(Array(n))).map((function(e,n){var c="".concat(t).concat(f).concat(n),a=C[c];return Object(P.jsx)(r.a.Fragment,{children:Object(P.jsx)(y.a,{width:24,height:24,borderRadius:.5,sx:{backgroundColor:"primary.dark","&:hover":{backgroundColor:"primary.main",opacity:[.9,.8,.7]}},onClick:function(){return e=c,void(m.includes(e)?(D(m.filter((function(t){return t!==e}))),B(de()(C,[e]))):(D([].concat(Object(E.a)(m),[e])),B(Object(s.a)(Object(s.a)({},C),{},Object(G.a)({},e.toString(),1)))));var e},children:m.includes(c)&&a?Object(P.jsx)(fe.ResizableBox,{height:24,width:24*a+2*(a-1),axis:"x",handleSize:[10,10],onResizeStop:function(e,t){!function(e,t){var n=t.split(f),c=Object(S.a)(n,2),r=c[0],a=c[1];if(m.includes("".concat(r).concat(f).concat(parseInt(a,10)+1)))Y();else{var i=Math.floor(e/32)+(e%32>0?1:0),o=parseInt(a,10)+i-1;[m.includes(o),o>h].some(Boolean)?Y():B(Object(s.a)(Object(s.a)({},C),{},Object(G.a)({},t,i)))}}(t.size.width,c)},children:Object(P.jsx)(y.a,{bgcolor:K,height:"100%",width:"100%",borderRadius:.5})}):null})},"col-".concat(n))}))]},"row-".concat(t));var n}))},J)]})};pe.defaultProps={trackColor:"yellow",trackName:"Track 1"};var he=pe,xe=function(e){var t=e.trackNumber,n=K(),c=n.cancelPlayAudio,r=n.playDuration,a=n.displayOverlay,i=n.resetProgress,o=n.playSingleAudio,s=O[t];return Object(P.jsxs)(y.a,{children:[Object(P.jsx)(Z,{onCancel:c,trackColor:s,playDuration:r,display:a,reset:i}),Object(P.jsx)(he,{trackColor:s,trackName:"Track ".concat(t),trackNumber:t,onPlay:o})]})},me=function(e){var t=e.trackNumber;return Object(P.jsx)(y.a,{bgcolor:"primary.bg",display:"flex",alignItems:"center",justifyContent:"center",height:"100vh",children:Object(P.jsx)(xe,{trackNumber:t})})},ve=function(){return Object(P.jsxs)(C.c,{children:[Object(P.jsx)(C.a,{path:"/",element:Object(P.jsx)($,{})}),b.map((function(e){return Object(P.jsx)(C.a,{path:"track-".concat(e),element:Object(P.jsx)(me,{trackNumber:e})},"track-".concat(e))}))]})};var ge=function(){var e=Object(u.a)({palette:{primary:Object(s.a)({},j)}});return Object(P.jsx)("div",{className:"App",children:Object(P.jsx)(l.a,{theme:e,children:Object(P.jsx)(L,{children:Object(P.jsx)(q,{children:Object(P.jsx)(ve,{})})})})})};i.a.render(Object(P.jsx)(o.a,{basename:"loop-maker",children:Object(P.jsx)(ge,{})}),document.getElementById("root"))}},[[138,1,2]]]);
//# sourceMappingURL=main.e9e7e965.chunk.js.map