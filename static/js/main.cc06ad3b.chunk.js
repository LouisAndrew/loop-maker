(this["webpackJsonploop-maker"]=this["webpackJsonploop-maker"]||[]).push([[0],{112:function(e,t,n){},114:function(e,t,n){},138:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(32),o=n.n(a),i=n(42),s=(n(112),n(113),n(5)),u=n(101),l=n(188),j={main:"#646464",secondary:"#fff",bg:"#3E3C3C",dark:"#525151",light:"#706c6c",red:"#ea9191",yellow:"#E3EA91",blue:"#91b9ea",green:"#91eabb",white:"#ccc"},b=[1,2,3,4,5],d={1:"red",2:"yellow",3:"blue",4:"green",5:"white"},O=(n(114),n(20)),f=n(189),h=n(4),x=function(){return Object(h.jsxs)("div",{children:[Object(h.jsx)("h1",{children:"Home View"}),b.map((function(e){return Object(h.jsx)(i.b,{to:"track-".concat(e),children:Object(h.jsxs)(f.a,{children:["Go to track"," ",e]})},"track-".concat(e,"-link"))}))]})},m=n(6),p=n.n(m),v=n(14),g=n(7),C=n(16),A=n(8),k=n(51),w=n(97),D=n.n(w),y=["B","A#","A","G#","G","F#","F","E","D#","D","C#","C"],E=(["C"].concat(y,y),"__"),F=8,G=4,B=2,I=1,S=["bass-electric","cello","flute","guitar-acoustic","guitar-electric","piano","saxophone","violin"],z={"bass-electric":["As5","G5","E5","Cs5","As4","G4","E4","Cs4","As3","G3","E3","Cs3","As2","G2","E2","Cs2"],cello:["B4","As4","A4","Gs4","G4","Fs4","F4","E4","Ds4","D4","Cs4","C4","B3","As3","A3","Gs3","G3","Fs3","F3","E3","Ds3","D3","Cs3","C3"],clarinet:["F2","D3","F3","D4","D5","F4","Fs5","As2","As3","As4","D2"],flute:["C6","A5","E5","C5","A4","E4","C4","A3","E3","C3"],"guitar-acoustic":["B3","As3","A3","Gs3","G3","Fs3","F3","E3","Ds3","D3","Cs3","C3","B2","As2","A2","Gs2","G2","Fs2","F2","E2","Ds2","D2","Cs2","C2"],"guitar-electric":["A5","Fs5","Ds5","C5","A4","Fs4","Ds4","C4","A3","Fs3","Ds3","C3"],harp:["B3","C5","D2","D4","D6","D7","E1","E3","E5","F2","F4","F6","F7","G1","G3","G5","A2","A4","A6","B1","B5","B6","C3"],piano:["C5","B4","As4","A4","Gs4","G4","Fs4","F4","E4","Ds4","D4","Cs4","C4","B3","As3","A3","Gs3","G3","Fs3","F3","E3","Ds3","D3","Cs3","C3"],saxophone:["B3","As3","A3","Gs3","G3","Fs3","F3","E3","Ds3","D3","Cs3","C3"],violin:["C6","A5","G5","E5","C5","A4","G4","E4","C4"]},M=n(190),N=function(e){var t=e.playDuration,n=e.trackColor,c=Object(r.useState)(Math.random()),a=Object(A.a)(c,2),o=a[0],i=a[1],s=Object(r.useState)(0),u=Object(A.a)(s,2),l=u[0],j=u[1],b=0!==t,d=function(){j(0),i(Math.random())};return Object(r.useEffect)((function(){var e;return t>0?e=setInterval((function(){j((function(e){return 100===e?e:e+1}))}),t/100):d(),function(){e&&(d(),clearInterval(e))}}),[t]),b?Object(h.jsxs)(f.a,{position:"absolute",bgcolor:"rgba(0, 0, 0, 0.1)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",sx:{backdropFilter:"blur(1px)",zIndex:99,top:0,left:0,right:0,bottom:0},children:[Object(h.jsx)(f.a,{color:"#fff",fontWeight:"bold",fontSize:"32px",children:"PLAYING AUDIO"}),Object(h.jsx)(f.a,{width:"20vw",color:"primary.".concat(n),sx:{marginTop:3},children:Object(h.jsx)(M.a,{color:"inherit",variant:"determinate",value:l},o)})]}):null};N.defaultProps={trackColor:"yellow"};var R=N,V=n(178),W=n(191),P=n(192),T=n(187),L=n(185),J=n(183),U=n(193),_=n(181),H=n(184),Y=n(100),q=n.n(Y),K=n(98),Q=n.n(K),X=n(99),Z=b.reduce((function(e,t){return Object(s.a)(Object(s.a)({},e),{},Object(g.a)({},t,[]))}),{}),$=b.reduce((function(e,t){return Object(s.a)(Object(s.a)({},e),{},Object(g.a)({},t,{}))}),{}),ee=b.reduce((function(e,t){return Object(s.a)(Object(s.a)({},e),{},Object(g.a)({},t,"piano"))}),{}),te=Object(r.createContext)({activeBoxes:Z,activeBoxesValues:$,instruments:ee}),ne=function(e){var t=e.children,n=Object(r.useState)(Z),c=Object(A.a)(n,2),a=c[0],o=c[1],i=Object(r.useState)($),u=Object(A.a)(i,2),l=u[0],j=u[1],d=Object(r.useState)(ee),O=Object(A.a)(d,2),f=O[0],x=O[1],m=Object(r.useCallback)((function(e){if(-1!==b.indexOf(e)){return{setActiveBox:function(t){o((function(n){return Object(s.a)(Object(s.a)({},n),{},Object(g.a)({},e,t))}))},setActiveBoxValues:function(t){j((function(n){return Object(s.a)(Object(s.a)({},n),{},Object(g.a)({},e,t))}))},setInstrument:function(t){x((function(n){return Object(s.a)(Object(s.a)({},n),{},Object(g.a)({},e,t))}))}}}return{setActiveBox:function(){},setActiveBoxValues:function(){},setInstrument:function(){}}}),[]);return Object(h.jsx)(te.Provider,{value:{getSetter:m,activeBoxes:a,activeBoxesValues:l,instruments:f},children:t})},re=function(e){var t=e.trackColor,n=void 0===t?"yellow":t,a=e.onPlay,o=e.trackName,u=void 0===o?"Track 1":o,l=e.trackNumber,j=Object(r.useContext)(te),b=j.getSetter,d=j.activeBoxes,O=j.activeBoxesValues,x=j.instruments,m=Object(r.useMemo)((function(){return d[l]}),[d]),p=Object(r.useMemo)((function(){return O[l]}),[O]),C=Object(r.useMemo)((function(){return x[l]}),[x]),k=Object(r.useMemo)((function(){return b(l)}),[l]),w=k.setActiveBox,D=k.setActiveBoxValues,y=k.setInstrument,F=Object(r.useState)(40),G=Object(A.a)(F,2),B=G[0],I=G[1],M=Object(r.useState)(120),N=Object(A.a)(M,2),R=N[0],Y=N[1];var K=Object(r.useState)(Math.random()),Z=Object(A.a)(K,2),$=Z[0],ee=Z[1],ne=Object(r.useMemo)((function(){return z[C]}),[C]),re=Object(r.useRef)(!0),ce=function(){return ee(Math.random())},ae=function(e){var t=e.split(E),n=Object(A.a)(t,2),r=n[0],c=n[1];return ne.length>parseInt(r,10)&&c<B};Object(r.useEffect)((function(){re.current?re.current=!1:ce()}),[m,p]),Object(r.useEffect)((function(){if(!re.current){var e=m.filter(ae),t=Object.keys(p).filter(ae);w(e),D(t.map((function(e){return Object(g.a)({},e,p[e])})).reduce((function(e,t){return Object(s.a)(Object(s.a)({},e),t)}),{}))}}),[ne,B]);var oe="primary.".concat(n);return Object(h.jsxs)(V.a,{children:[Object(h.jsxs)(V.a,{direction:"row",alignItems:"flex-end",paddingBottom:2,spacing:5,children:[Object(h.jsxs)(V.a,{direction:"row",alignItems:"center",justifyContent:"flex-start",spacing:3,children:[Object(h.jsx)(i.b,{to:"/",children:Object(h.jsx)(W.a,{"aria-label":"back",sx:{color:oe},children:Object(h.jsx)(q.a,{})})}),Object(h.jsx)(P.a,{color:oe,variant:"h5",fontWeight:"bold",sx:{marginLeft:"14px"},children:u}),Object(h.jsx)(T.a,{onClick:function(){a(m.map((function(e){var t;return"".concat(e).concat(E).concat(null!==(t=p[e])&&void 0!==t?t:0)})),C,R)},sx:{backgroundColor:oe,marginLeft:"28px",marginRight:"14px","&:hover":{backgroundColor:oe}},children:"Play"}),Object(h.jsx)(T.a,{onClick:function(){w([]),D([])},variant:"outlined",sx:{color:oe,borderColor:oe},children:"Clear"})]}),Object(h.jsxs)(V.a,{direction:"row",alignItems:"flex-end",spacing:1,children:[Object(h.jsxs)(f.a,{sx:{width:120},children:[Object(h.jsxs)(L.a,{id:"tempo",sx:{color:oe},children:["Tempo:"," ",R]}),Object(h.jsx)(J.a,{size:"small",value:R,id:"tempo",max:180,min:80,onChange:function(e,t){Y(t)}})]}),Object(h.jsx)(f.a,{sx:{width:80},children:Object(h.jsxs)(U.a,{size:"small",sx:{minWidth:80},children:[Object(h.jsxs)(L.a,{id:"grid-size",sx:{color:oe},children:["Grid length:",B]}),Object(h.jsx)(_.a,{labelId:"grid-size",id:"grid-size-input",value:B,label:"Grid length",autoWidth:!0,variant:"filled",onChange:function(e){return I(parseInt(e.target.value,10))},sx:{color:oe},children:[32,36,40,44,48,52].map((function(e){return Object(h.jsx)(H.a,{value:e,children:e},e)}))})]})}),Object(h.jsx)(f.a,{sx:{width:64},children:Object(h.jsxs)(U.a,{size:"small",sx:{minWidth:80},children:[Object(h.jsx)(L.a,{id:"instrument",sx:{color:oe},children:"Instrument"}),Object(h.jsx)(_.a,{labelId:"instrument",id:"instrument-input",value:C,defaultValue:"piano",label:"Instrument",autoWidth:!0,variant:"filled",onChange:function(e){return y(e.target.value)},sx:{color:oe},children:S.map((function(e){return Object(h.jsx)(H.a,{value:e,children:e},e)}))})]})})]})]}),Object(h.jsx)(V.a,{spacing:.25,children:ne.map((function(e,t){return Object(h.jsxs)(V.a,{width:"fit-content",spacing:.25,direction:"row",alignItems:"center",sx:{borderWidth:1,borderStyle:"solid",borderColor:"transparent",borderRadius:.5,"&:hover":{borderColor:oe,transition:"200ms"}},children:[Object(h.jsx)(f.a,{height:24,width:50,display:"flex",alignItems:"center",justifyContent:"center",fontWeight:"bold",color:oe,children:e.replace("s","#")}),(n=B,Array.from(Array(n))).map((function(e,n){var r="".concat(t).concat(E).concat(n),a=p[r];return Object(h.jsx)(c.a.Fragment,{children:Object(h.jsx)(f.a,{width:24,height:24,borderRadius:.5,sx:{backgroundColor:"primary.dark","&:hover":{backgroundColor:"primary.main",opacity:[.9,.8,.7]}},onClick:function(){return e=r,void(m.includes(e)?(w(m.filter((function(t){return t!==e}))),D(Q()(p,[e]))):(w([].concat(Object(v.a)(m),[e])),D(Object(s.a)(Object(s.a)({},p),{},Object(g.a)({},e.toString(),1)))));var e},children:m.includes(r)&&a?Object(h.jsx)(X.ResizableBox,{height:24,width:24*a+2*(a-1),axis:"x",handleSize:[10,10],onResizeStop:function(e,t){!function(e,t){var n=t.split(E),r=Object(A.a)(n,2),c=r[0],a=r[1];if(m.includes("".concat(c).concat(E).concat(parseInt(a,10)+1)))ce();else{var o=Math.floor(e/32)+(e%32>0?1:0),i=parseInt(a,10)+o-1;[m.includes(i),i>B].some(Boolean)?ce():D(Object(s.a)(Object(s.a)({},p),{},Object(g.a)({},t,o)))}}(t.size.width,r)},children:Object(h.jsx)(f.a,{bgcolor:oe,height:"100%",width:"100%",borderRadius:.5})}):null})},"col-".concat(n))}))]},"row-".concat(t));var n}))},$)]})};re.defaultProps={trackColor:"yellow",trackName:"Track 1"};var ce=re,ae=function(e){var t=e.trackNumber,n=Object(r.useState)(0),c=Object(A.a)(n,2),a=c[0],o=c[1],i=d[t],u=function(e,t){return[Math.floor(e/t),e%t]},l=function(e){var t=u(e,F),n=Object(A.a)(t,2),r=n[0],c=n[1],a=u(c,G),o=Object(A.a)(a,2),i=o[0],s=o[1],l=u(s,B),j=Object(A.a)(l,2),b=j[0],d=j[1],O=u(d,I);return{"1n":r,"2n":i,"4n":b,"8n":Object(A.a)(O,1)[0]}},j=function(e){return k.b.toSeconds(e)},b=function(){var e=Object(C.a)(p.a.mark((function e(t,n,r){var c,a,i,u;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:k.b.bpm.value=r,c=t.map((function(e){var t=e.split(E),n=Object(A.a)(t,3),r=n[0],c=n[1],a=n[2];return{row:r,duration:l(a),start:l(c)}})),a=Object.entries(D()(c,(function(e){return e.row}))).map((function(e){var t=Object(A.a)(e,2),r=t[0],c=t[1];return{note:z[n][r],noteDatas:c}})),c.length>0&&(i=a.reduce((function(e,t){return Object(s.a)(Object(s.a)({},e),{},Object(g.a)({},t.note.replace("s","#").toString(),t.note+".mp3"))}),{}),u=new k.a({urls:i,baseUrl:"https://louisandrew.github.io/loop-maker/samples/"+n+"/",onload:function(){var e=Object(C.a)(p.a.mark((function e(){var t,n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Object(v.a)(c).map((function(e){return t=e.start,n=e.duration,1e3*(j(t)+j(n));var t,n})),n=t.sort((function(e,t){return t-e}))[0],o(n),setTimeout((function(){o(0),u.dispose()}),n+500),k.b.cancel(n/1e3),e.next=7,k.c();case 7:a.forEach((function(e){var t=e.note;e.noteDatas.forEach((function(e){var n=e.duration,r=e.start;u.triggerAttackRelease(t.replace("s","#"),n,"+"+j(r))}))}));case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}).toDestination());case 4:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}();return Object(h.jsxs)(f.a,{children:[Object(h.jsx)(R,{trackColor:i,playDuration:a}),Object(h.jsx)(ce,{trackColor:i,trackName:"Track "+t,trackNumber:t,onPlay:b})]})},oe=function(e){var t=e.trackNumber;return Object(h.jsx)(f.a,{bgcolor:"primary.bg",display:"flex",alignItems:"center",justifyContent:"center",height:"100vh",children:Object(h.jsx)(ae,{trackNumber:t})})},ie=function(){return Object(h.jsxs)(O.c,{children:[Object(h.jsx)(O.a,{path:"/",element:Object(h.jsx)(x,{})}),b.map((function(e){return Object(h.jsx)(O.a,{path:"track-".concat(e),element:Object(h.jsx)(oe,{trackNumber:e})},"track-".concat(e))}))]})};var se=function(){var e=Object(u.a)({palette:{primary:Object(s.a)({},j)}});return Object(h.jsx)("div",{className:"App",children:Object(h.jsx)(l.a,{theme:e,children:Object(h.jsx)(ne,{children:Object(h.jsx)(ie,{})})})})};o.a.render(Object(h.jsx)(i.a,{basename:"loop-maker",children:Object(h.jsx)(se,{})}),document.getElementById("root"))}},[[138,1,2]]]);
//# sourceMappingURL=main.cc06ad3b.chunk.js.map